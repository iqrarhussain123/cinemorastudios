---
const primaryCta = { label: "Book a Strategy Call", href: "#book" };
const secondaryCta = { label: "See Proof", href: "#proof" };

// Put your video here: /public/videos/showreel.mp4
const videoSrc = "/videos/showreel.mp4";

// Put your thumbnail here: /public/images/hero-video-thumb.jpg (1920x1080)
const posterSrc = "/images/hero-video-thumb.jpg";
---

<section class="hero-section relative overflow-hidden bg-transparent">
  <div class="relative z-10">
    <div
      class="mx-auto flex w-full max-w-[100rem] flex-col gap-8 px-4 sm:px-6 pt-24 pb-32 sm:pt-28 md:pt-36 md:pb-40"
    >
      <!-- top pill -->
      <div
        class="hero-pill hero-reveal-1 mx-auto mb-4 inline-flex w-fit items-center gap-1.5 rounded-full border border-zinc-800/80 bg-zinc-900/50 px-3 py-1.5 text-xs text-zinc-200 backdrop-blur-md"
      >
        <span class="h-2 w-2 rounded-full bg-lime-400"></span>
        Content systems that convert
      </div>

      <!-- Text block -->
      <div class="mx-auto mt-2 max-w-4xl text-center">
        <h1
          class="hero-title hero-reveal-2 text-4xl font-extrabold leading-tight tracking-tight text-zinc-50 sm:text-5xl md:text-7xl"
        >
          We turn <span class="text-lime-400">attention</span><br />
          into <span class="text-lime-400">clients.</span>
        </h1>

        <div
          class="hero-sub hero-reveal-3 mx-auto mt-12 w-full max-w-2xl text-left"
        >
          <div class="relative w-full">
            <!-- Static Image Background -->
            <img
              src="/images/typing-bar-bg.png"
              alt="AI Input Interface"
              class="w-full rounded-[2rem] shadow-2xl"
            />

            <!-- Typing Text Overlay -->
            <!-- Typing Text Overlay -->
            <div class="absolute inset-0 flex flex-col">
              <!-- Text Zone (Use smallest spacer possible) -->
              <div class="flex-1 overflow-hidden px-6 pt-5 sm:px-8 sm:pt-6">
                <div
                  class="relative w-full text-sm font-light leading-snug text-zinc-100 sm:text-base md:text-lg"
                >
                  <span id="typing-text"></span><span
                    class="animate-pulse font-light text-lime-400">|</span
                  >
                </div>
              </div>

              <!-- Protected Bottom Zone (Tools Area) -->
              <div class="h-12 w-full shrink-0"></div>
            </div>
          </div>
        </div>

        <script is:inline>
          // Typing effect
          const typeText =
            "Helping elite coaches build authority and real estate brands dominate with premium content.";
          const typeEl = document.getElementById("typing-text");
          let charIndex = 0;

          if (typeEl) {
            setTimeout(() => {
              const type = () => {
                if (charIndex < typeText.length) {
                  typeEl.textContent += typeText.charAt(charIndex);
                  charIndex++;
                  setTimeout(type, 30);
                }
              };
              type();
            }, 500);
          }
        </script>

        <div
          class="hero-ctas hero-reveal-4 mt-8 flex flex-col justify-center gap-4 sm:flex-row"
        >
          <!-- Primary Premium Button -->
          <a
            href={primaryCta.href}
            class="group relative inline-flex items-center justify-center gap-2 overflow-hidden rounded-full bg-gradient-to-r from-lime-400 to-lime-500 px-8 py-3.5 text-base font-bold text-zinc-950 shadow-[0_0_20px_-5px_rgba(163,230,53,0.4)] transition-all duration-300 hover:scale-105 hover:shadow-[0_0_30px_-5px_rgba(163,230,53,0.6)]"
          >
            <span class="relative z-10">{primaryCta.label}</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2.5"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="relative z-10 transition-transform duration-300 group-hover:translate-x-1"
              ><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg
            >
            <div
              class="absolute inset-0 -z-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"
            >
            </div>
          </a>

          <!-- Secondary Glass Button -->
          <a
            href={secondaryCta.href}
            class="group relative inline-flex items-center justify-center gap-2 overflow-hidden rounded-full border border-white/10 bg-white/5 px-8 py-3.5 text-base font-semibold text-white backdrop-blur-md transition-all duration-300 hover:border-white/20 hover:bg-white/10"
          >
            <span>{secondaryCta.label}</span>
            <div
              class="absolute inset-0 -z-10 bg-gradient-to-r from-lime-400/10 to-transparent opacity-0 blur-xl transition-opacity duration-500 group-hover:opacity-100"
            >
            </div>
          </a>
        </div>
      </div>

      <!-- Big video under text (Thumbnail + Hover-to-play) -->
      <div
        class="hero-video hero-reveal-6 mt-16 md:mt-20 px-2 sm:px-6 perspective-1000"
      >
        <div
          id="videoTiltContainer"
          class="mx-auto max-w-[95rem] rounded-[2rem] border border-white/5 bg-white/5 p-2 shadow-[0_0_150px_-30px_rgba(163,230,53,0.15)] ring-1 ring-white/10 backdrop-blur-3xl transition-transform duration-100 ease-out md:p-3"
          style="transform-style: preserve-3d;"
        >
          <!-- Mute Toggle Button (Apple UI Style) -->
          <button
            id="muteToggle"
            class="absolute right-4 top-4 z-20 flex h-10 w-10 items-center justify-center rounded-full border border-white/10 bg-black/30 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:bg-black/50 active:scale-95"
            aria-label="Toggle sound"
          >
            <!-- Muted Icon (Default) -->
            <svg
              id="iconMuted"
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="text-white"
            >
              <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
              <line x1="23" x2="1" y1="1" y2="23"></line>
            </svg>
            <!-- Unmuted Icon (Hidden) -->
            <svg
              id="iconUnmuted"
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="hidden text-white"
            >
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
              <path
                d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"
              ></path>
            </svg>
          </button>

          <video
            id="heroVideo"
            class="h-full w-full object-cover"
            muted
            playsinline
            preload="metadata"
            poster={posterSrc}
          >
            <source src={videoSrc} type="video/mp4" />
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Hover logic (Astro-safe) -->
<script is:inline>
  // Video Hover Logic & 3D Tilt
  const wrap = document.getElementById("heroVideoWrap");
  const video = document.getElementById("heroVideo");
  const tiltContainer = document.getElementById("videoTiltContainer");
  const shine = document.getElementById("videoShine");
  const muteBtn = document.getElementById("muteToggle");
  const iconMuted = document.getElementById("iconMuted");
  const iconUnmuted = document.getElementById("iconUnmuted");

  if (wrap && video && muteBtn) {
    // Toggle Mute
    muteBtn.addEventListener("click", (e) => {
      e.stopPropagation(); // Prevent playing/pausing if wrap has click listeners
      video.muted = !video.muted;

      // Toggle Icons
      if (video.muted) {
        iconMuted.classList.remove("hidden");
        iconUnmuted.classList.add("hidden");
      } else {
        iconMuted.classList.add("hidden");
        iconUnmuted.classList.remove("hidden");
      }
    });

    wrap.addEventListener("mouseenter", async () => {
      try {
        // Keep current time if already playing?
        // Logic says reset to 0 on enter.
        video.currentTime = 0;
        await video.play();
      } catch (e) {}
    });

    wrap.addEventListener("mouseleave", () => {
      video.pause();
      video.currentTime = 0;
      // Don't reload, just pause and reset
    });
  }

  // 3D Tilt Logic
  if (tiltContainer && shine) {
    document.addEventListener("mousemove", (e) => {
      const { clientX, clientY } = e;
      const width = window.innerWidth;
      const height = window.innerHeight;

      // Calculate percentage from center (-1 to 1)
      const xPct = (clientX / width - 0.5) * 2;
      const yPct = (clientY / height - 0.5) * 2;

      // Tilt intensity
      const tiltX = yPct * -2; // Rotate X axis (up/down looking)
      const tiltY = xPct * 2; // Rotate Y axis (left/right looking)

      tiltContainer.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;

      // Dynamic Shine position/opacity
      shine.style.opacity = Math.min(Math.abs(xPct) + Math.abs(yPct), 0.6);
      shine.style.background = `linear-gradient(${135 + xPct * 45}deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 60%)`;
    });
  }
</script>

<style>
  @import url("https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&display=swap");

  .hero-section {
    min-height: 100svh;
  }

  .hero-reveal-1 {
    animation-delay: 80ms;
  }
  .hero-reveal-2 {
    animation-delay: 160ms;
  }
  .hero-reveal-3 {
    animation-delay: 240ms;
  }
  .hero-reveal-4 {
    animation-delay: 320ms;
  }
  .hero-reveal-5 {
    animation-delay: 400ms;
  }
  .hero-reveal-6 {
    animation-delay: 520ms;
  }

  .hero-pill {
    opacity: 0;
    animation: hero-pill 900ms ease forwards;
  }

  .hero-title {
    opacity: 0;
    animation: hero-title 900ms ease forwards;
  }

  .hero-sub {
    opacity: 0;
    animation: hero-sub 900ms ease forwards;
  }

  .hero-ctas {
    opacity: 0;
    animation: hero-ctas 900ms ease forwards;
  }

  .hero-tags {
    opacity: 0;
    animation: hero-tags 900ms ease forwards;
  }

  .hero-video {
    opacity: 0;
    animation: hero-video 900ms ease forwards;
  }

  @keyframes hero-pill {
    from {
      opacity: 0;
      transform: translateY(12px) scale(0.96);
      filter: blur(4px);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
      filter: blur(0);
    }
  }

  @keyframes hero-title {
    from {
      opacity: 0;
      transform: translateY(22px);
      letter-spacing: 0.02em;
    }
    to {
      opacity: 1;
      transform: translateY(0);
      letter-spacing: 0;
    }
  }

  @keyframes hero-sub {
    from {
      opacity: 0;
      transform: translateY(16px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes hero-ctas {
    from {
      opacity: 0;
      transform: translateY(12px) scale(0.98);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @keyframes hero-tags {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes hero-video {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.985);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .hero-pill,
    .hero-title,
    .hero-sub,
    .hero-ctas,
    .hero-tags,
    .hero-video {
      animation: none;
      opacity: 1;
      transform: none;
      filter: none;
    }
  }

  @media (max-width: 640px) {
    .hero-title {
      font-family: "Playfair Display", "Times New Roman", serif;
    }
  }
</style>
